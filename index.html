<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Exchange Calculator</title>
    <script src="https://cdn.tailwindcss.com"></script>
  </head>
  <body class="bg-blue-500">
    <div class="p-4">
      <input
        type="number"
        class="border border-gray-600 p-2 rounded-md min-w-[480px]"
        placeholder="Ingresar monto a cambiar"
        id="monto"
      />
      <button
        type="submit"
        id="button"
        class="bg-gray-600 text-white p-2 rounded-md"
      >
        Calcular
      </button>
      <div class="p-2 my-2 bg-gray-400">
        <h3 class="text-lg font-medium underline">Cambio Ontop</h3>
        <span class="block"><b>Flat fee:</b> -1,54 USD</span>
        <span class="block"><b>Comision de CCL:</b> -7,5%</span>
        <div class="border-2 border-gray-700 max-w-[500px]"></div>
        <p id="total-ontop">Total: Cambio:</p>
        <br />
        <h3 class="text-lg font-medium underline">Cambio Lemon Cash</h3>
        <span class="block"><b>Comision de red BEP-20:</b> -0,8 USD</span>
        <span class="block"><b>Comision de Lemon Venta cripto:</b> -0,5%</span>
        <div class="border-2 border-gray-700 max-w-[500px]"></div>
        <p id="total-lemon">Total: Cambio:</p>
      </div>
    </div>
  </body>
  <script>
    const calcular = document.querySelector("#button");
    const monto = document.querySelector("#monto");

    async function getDolarCCL() {
      try {
        const response = await fetch(
          "https://mercados.ambito.com//dolarrava/cl/variacion"
        );
        var data = await response.json();
        var dolarCCL = parseFloat(data.compra);
        console.log(dolarCCL);
        document.querySelector("#total-ontop").innerText = `
              Dolar CCL = $${dolarCCL}
              TOTAL = $${dolarCCL * 0.925 * parseFloat(monto.value)}
              `;
      } catch (error) {
        console.log(error);
      }
    }

    async function getDolarCrypto() {
      try {
        const response = await fetch(
          "https://api.cryptosaurio.com/ar/prices/ARS/USDC/ask,bid",
          {
            method: "GET",
            mode: "no-cors",
          }
        );
        var data = await response.json();
        console.log(data);
      } catch (error) {
        console.log(error);
      }
    }
    calcular.addEventListener("click", function () {
      getDolarCCL();
      getDolarCrypto();
    });
  </script>
</html>
